<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head lang="de" th:replace="template :: header"></head>
	<body>
		<nav th:replace="template :: nav"></nav>
		<main class="container pt-3">
			<div class="card mb-3">
				<div class="card-header text-center"><h3 class="mb-0">Projektdetails</h3></div>
				<div class="card-block p-3">				
					<div class="col-lg-12 text-center">
						<form th:action="@{${urlSubmit}}" th:object="${project}" method="post">

					        <input id="project" name="project" th:field="*{idProject}" type="hidden" />
			
							<div class="form-group">
								<input th:field="*{projectName}" class="form-control" placeholder="Projektname" required="required" />
								<span th:errors="*{projectName}" class="text-warning"></span>
							</div>								
							
							<div class="form-group">
								<div class="custom-control custom-checkbox">
								 	<input type="checkbox" class="custom-control-input" th:field="*{running}" id="running" disabled="disabled">
									<label class="custom-control-label" for="running">Projekt aktiv</label>
									<span th:errors="*{running}" class="text-warning"></span>
								</div>
							</div>
														
							<div class="form-group">
								<div class="input-group date" id="datetimepicker1" data-target-input="nearest">
									<div class="input-group-prepend" data-target="#datetimepicker1" data-toggle="datetimepicker">
										<span class="input-group-text"><i class="fas fa-calendar-alt"></i></span>
									</div>
									<input type="text" th:field="*{startDate}" class="form-control datetimepicker-input" data-toggle="datetimepicker" data-target="#datetimepicker1" placeholder="Startdatum: TT.MM.JJJJ HH:MM" required="required" />
									<span th:errors="*{startDate}" class="text-warning"></span>
								</div>
							</div>
							<div class="form-group">
								<div class="input-group date" id="datetimepicker2" data-target-input="nearest">
									<div class="input-group-prepend" data-target="#datetimepicker2" data-toggle="datetimepicker">
										<span class="input-group-text"><i class="fas fa-calendar-alt"></i></span>
									</div>
									<input type="text" th:field="*{endDate}" class="form-control datetimepicker-input" data-toggle="datetimepicker" data-target="#datetimepicker2" placeholder="Enddatum: TT.MM.JJJJ HH:MM" required="required" />
									<span th:errors="*{endDate}" class="text-warning"></span>
								</div>
							</div>

							<script type="text/javascript">
						
								$.fn.datetimepicker.Constructor.Default = $.extend({}, $.fn.datetimepicker.Constructor.Default, {
						            icons: {
						                time: 'far fa-clock',
						                date: 'far fa-calendar',
						                up: 'far fa-arrow-up',
						                down: 'far fa-arrow-down',
						                previous: 'far fa-chevron-left',
						                next: 'far fa-chevron-right',
						                today: 'far fa-calendar-check-o',
						                clear: 'far fa-trash',
						                close: 'far fa-times'
						            }
								});
						
						
							    $(function () {
									$('#datetimepicker1').datetimepicker({
							            format: 'DD.MM.YYYY HH:mm'
							    	});
									$('#datetimepicker2').datetimepicker({
							            format: 'DD.MM.YYYY HH:mm'
									});
							    });
							</script>

							<h4 class="mt-4">Bewertungsobjekte</h4>

							<div th:remove="tag" th:each="ratingObject, iterStat : *{ratingObjectList}" th:object="${ratingObject}">
								
								<div class="input-group mb-3">	
									<div class="input-group-prepend">
										<span class="input-group-text" th:id="'basic-addon'+${iterStat.index}" th:text="${iterStat.count}"></span>
									</div>															   
									<input type="text"
										th:field="${project.ratingObjectList[__${iterStat.index}__].name}" class="form-control" required="required"
										th:attr="aria-describedby='basic-addon'+${iterStat.index}" />
									<span th:errors="${project.ratingObjectList[__${iterStat.index}__].name}" class="text-warning"></span>
								</div>
																
							</div>
							
							<div id="buttonMarker"></div>
							
							<div>
								<p class="text-error" th:text="${globalError}"></p>
							</div>
							
							<div class="form-group mb-0">
								<div class="form-group">
									<button type="button" id="addRatingObject" class="btn btn-secondary">
										Bewertungsobjekt<br /><i class="fas fa-plus"></i>
									</button>
									
									<script th:inline="javascript">
									
										var ratingObjectNumber = [[${#lists.size(project.ratingObjectList)}]];
										var ratingObjectIndex = [[${#lists.size(project.ratingObjectList)}]];
									
										$(document).ready(function(){
											$("#addRatingObject").click(function(){
												ratingObjectNumber += 1;
												$("#buttonMarker").before(""
													+ "<div class='input-group mb-3'>"	
													+ "	<div class='input-group-prepend'>"
													+ "		<span class='input-group-text' id='basic-addon" + ratingObjectIndex + "'>" + ratingObjectNumber + "</span>"
													+ "	</div>"
													+ "	<input type='text'"
													+ "		id='ratingObjectList" + ratingObjectIndex + ".name'"
													+ "		name='ratingObjectList[" + ratingObjectIndex + "].name'"
													+ "		value='Wertungsobjekt'" + ratingObjectNumber
													+ "		class='form-control' required='required'"
													+ "		aria-describedby='basic-addon" +  ratingObjectIndex + "' />"
													+ "</div>");
												ratingObjectIndex += 1;
												});
											});
									</script>
									<button type="submit" id="submit" class="btn btn-primary">
										Speichern<br /><i class="fas fa-save"></i>
									</button>
								</div>
							</div>
						</form>
					</div>	
				</div>
				<div class="card-footer">&nbsp;</div>
			</div>
		</main>
		<footer th:replace="template :: footer"></footer>
	</body>
</html>
